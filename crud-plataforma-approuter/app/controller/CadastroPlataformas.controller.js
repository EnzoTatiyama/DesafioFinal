sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/m/MessageBox"],function(t,a,e){"use strict";return t.extend("desafio.l4e.app.controller.CadastroPlataformas",{onInit:function(){this.getRouter().getRoute("CadastroPlataformas").attachPatternMatched(this.handleRouteMatched,this);this.getRouter().getRoute("EditarPlataformas").attachPatternMatched(this.handleRouteMatchedEditarPlataformas,this)},handleRouteMatched:function(){this.getView().setModel(new a({status:"A"}),"Plataformas")},handleRouteMatchedEditarPlataformas:async function(){var t=this;var s=this.getRouter().getHashChanger().getHash().split("/")[1];this.getView().setBusy(true);await $.ajax({url:`/api/plataformas/${s}`,method:"GET",success(e){t.getView().setModel(new a(e),"Plataformas")},error(){e.error("Não foi possível buscar a plataforma.")}});this.getView().setBusy(false)},onChangeSwitch:function(t){this.getView().getModel("Plataformas").setProperty("/status",t.getSource().getState()===true?"A":"I")},onConfirmar:async function(){var t=this.getView().getModel("Plataformas").getData();var a=this;if(this.getRouter().getHashChanger().getHash().search("EditarPlataformas")===0){await $.ajax(`/api/plataformas/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},data:JSON.stringify({nome:t.nome,status:t.status}),success(){e.success("Editado com sucesso!",{onClose:function(){a.getRouter().navTo("ConsultaPlataformas")}})},error(){e.error("Não foi possível editar a plataforma.")}})}else{this.getView().setBusy(true);await $.ajax("/api/plataformas",{method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(t),success(){e.success("Salvo com sucesso!")},error(){e.error("Não foi possível salvar a plataforma.")}});this.getView().setBusy(false)}},onCancelar:function(){if(this.getRouter().getHashChanger().getHash().search("EditarPlataformas")===0){this.getRouter().navTo("ConsultaPlataformas")}else{this.getView().setModel(new a({status:"A"}),"Plataformas")}}})});